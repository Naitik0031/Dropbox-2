<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Dropbox Upload</title>
</head>
<body style="background:#111; color:#0ff; font-family:sans-serif; text-align:center; padding:40px;">

  <h1>üìÇ Upload File to Dropbox</h1>
  <input type="file" id="fileInput" />
  <button id="uploadBtn">Upload</button>
  <pre id="output"></pre>

  <script>
    document.getElementById("uploadBtn").addEventListener("click", async () => {
      const file = document.getElementById("fileInput").files[0];
      if (!file) return alert("Please select a file first");

      const reader = new FileReader();
      reader.onload = async function() {
        const base64File = reader.result.split(",")[1];
        const bodyData = { fileName: file.name, fileContent: base64File };

        try {
          const response = await fetch("/api/upload", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify(bodyData),
          });

          const text = await response.text();
          let data;
          try {
            data = JSON.parse(text);
          } catch {
            throw new Error("Invalid JSON: " + text);
          }
          document.getElementById("output").textContent = JSON.stringify(data, null, 2);
        } catch (error) {
          document.getElementById("output").textContent = "‚ùå Error: " + error.message;
        }
      };
      reader.readAsDataURL(file);
    });
  </script>

</body>
</html>